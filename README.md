porting muchas from js to ts.